import{b as tt,c as et,d as ot,e as nt}from"./chunk-T5UW3JXQ.js";import{Ab as K,Ba as C,Bb as j,Ea as i,Ja as g,Oa as p,S,Sa as f,Tb as x,Ub as O,Wb as Q,X as U,Xb as l,ab as a,cc as w,da as _,ea as b,eb as r,fb as s,gb as c,hb as F,ib as T,kb as M,ma as q,mb as y,nb as v,rb as E,sb as m,sc as X,tb as P,ub as I,uc as Z,zb as J}from"./chunk-P2P3GMIO.js";var N=class o{constructor(e,t){this.dialogRef=e;this.data=t}close(){this.dialogRef.close()}static \u0275fac=function(t){return new(t||o)(g(tt),g(et))};static \u0275cmp=p({type:o,selectors:[["app-story-modal"]],decls:10,vars:1,consts:[[1,"story-modal"],[1,"story-header"],[1,"user-info"],["src","https://ilarge.lisimg.com/image/16670334/1118full-roman-reigns.jpg","alt","User",1,"avatar"],[1,"username"],[1,"close-btn",3,"click"],[1,"story-content"],["autoplay","","muted","","controls","",1,"story-video",3,"src"]],template:function(t,n){t&1&&(r(0,"div",0)(1,"div",1)(2,"div",2),c(3,"img",3),r(4,"span",4),m(5,"Roman"),s()(),r(6,"button",5),y("click",function(){return n.close()}),m(7,"\xD7"),s()(),r(8,"div",6),c(9,"video",7),s()()),t&2&&(i(9),a("src",n.data.storyUrl,C))},dependencies:[l,nt],styles:[".story-modal[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#000000f2;display:flex;flex-direction:column;justify-content:flex-start;z-index:9999}.story-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:16px;color:#fff}.user-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.avatar[_ngcontent-%COMP%]{width:36px;height:36px;border-radius:50%;object-fit:cover;border:2px solid #fff}.username[_ngcontent-%COMP%]{font-weight:500;font-size:16px}.close-btn[_ngcontent-%COMP%]{font-size:28px;color:#fff;background:transparent;border:none;cursor:pointer;padding:0 12px;line-height:1}.story-content[_ngcontent-%COMP%]{flex:1;display:flex;justify-content:center;align-items:center}.story-video[_ngcontent-%COMP%]{max-height:90vh;max-width:100%;border-radius:10px;box-shadow:0 0 12px #0009}"]})};var D=class o{constructor(e){this.http=e}apiUrl="https://localhost:7038/api/Story";uploadStory(e){return this.http.post(this.apiUrl,e)}getActiveStories(){return this.http.get(this.apiUrl)}static \u0275fac=function(t){return new(t||o)(U(w))};static \u0275prov=S({token:o,factory:o.\u0275fac,providedIn:"root"})};function pt(o,e){if(o&1){let t=M();F(0),r(1,"div",4),y("click",function(d){return _(t),E(6).click(),b(d.stopPropagation())}),c(2,"img",5),r(3,"span",6),m(4,"+"),s()(),r(5,"input",7,1),y("change",function(d){_(t);let W=v();return b(W.onFileSelected(d))}),s(),r(7,"p",8),m(8,"Your Story"),s(),T()}if(o&2){let t=v();i(2),a("src",t.profilePictureUrl||"assets/default-avatar.png",C)}}function lt(o,e){if(o&1&&(c(0,"img",5),r(1,"p",8),m(2),s()),o&2){let t=v();a("src",t.profilePictureUrl,C),i(2),P(t.isCurrentUser?"Your Story":t.username)}}var A=class o{constructor(e,t){this.storyService=e;this.dialog=t}username;profilePictureUrl;storyUrl;storyUploaded=new q;isCurrentUser=!1;stories=[];ngOnInit(){console.log("StoryComponent loaded with:",this.storyUrl)}onFileSelected(e){let t=e.target.files[0];if(!t)return;let n=new FormData;n.append("file",t),this.storyService.uploadStory(n).subscribe({next:()=>{this.storyUploaded.emit()},error:()=>alert("Upload failed")})}openStory(e){this.dialog.open(N,{data:{storyUrl:e},width:"600px"})}static \u0275fac=function(t){return new(t||o)(g(D),g(ot))};static \u0275cmp=p({type:o,selectors:[["app-story"]],inputs:{username:"username",profilePictureUrl:"profilePictureUrl",storyUrl:"storyUrl",isCurrentUser:"isCurrentUser"},outputs:{storyUploaded:"storyUploaded"},decls:4,vars:2,consts:[["storyExists",""],["fileInput",""],[1,"story",3,"click"],[4,"ngIf","ngIfElse"],[1,"upload-avatar-wrapper",3,"click"],["alt","Story",1,"story-avatar",3,"src"],[1,"plus-icon"],["type","file","accept","video/*",3,"change"],[1,"story-username"]],template:function(t,n){if(t&1){let d=M();r(0,"div",2),y("click",function(){return _(d),b(n.storyUrl?n.openStory(n.storyUrl):null)}),f(1,pt,9,1,"ng-container",3)(2,lt,3,2,"ng-template",null,0,j),s()}if(t&2){let d=E(3);i(),a("ngIf",n.isCurrentUser&&!n.storyUrl)("ngIfElse",d)}},dependencies:[l,O],styles:[".story-container[_ngcontent-%COMP%]{display:flex;gap:16px;padding:10px}.story[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;cursor:pointer;width:70px;margin-top:5px;position:relative}.story-avatar[_ngcontent-%COMP%]{width:60px;height:60px;border-radius:50%;object-fit:cover;border:2px solid #c13584;transition:transform .2s ease}.story[_ngcontent-%COMP%]:hover   .story-avatar[_ngcontent-%COMP%]{transform:scale(1.05)}.story-username[_ngcontent-%COMP%]{margin-top:5px;font-size:12px;color:#fff;text-align:center;max-width:70px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.upload-avatar-wrapper[_ngcontent-%COMP%]{position:relative;width:60px;height:60px}.upload-avatar-wrapper[_ngcontent-%COMP%]   .story-avatar[_ngcontent-%COMP%]{border:2px dashed #888;background-color:#222;opacity:.8}.plus-icon[_ngcontent-%COMP%]{position:absolute;bottom:-4px;right:-4px;background-color:#0095f6;color:#fff;border-radius:50%;width:20px;height:20px;display:flex;align-items:center;justify-content:center;font-size:16px;border:2px solid black;z-index:2}input[type=file][_ngcontent-%COMP%]{display:none}"]})};var H=class o{likes=[];toggleLike(){alert("Toggled Like!")}static \u0275fac=function(t){return new(t||o)};static \u0275cmp=p({type:o,selectors:[["app-post-actions"]],inputs:{likes:"likes"},decls:5,vars:1,consts:[[1,"post-actions"],[3,"click"]],template:function(t,n){t&1&&(r(0,"div",0)(1,"button",1),y("click",function(){return n.toggleLike()}),m(2,"\u2764\uFE0F Like"),s(),r(3,"span"),m(4),s()()),t&2&&(i(4),I("",n.likes.length," likes"))},dependencies:[l],styles:[".post-actions[_ngcontent-%COMP%]{margin-top:10px;display:flex;align-items:center;gap:10px;color:#faebd7}"]})};function mt(o,e){if(o&1&&(F(0),c(1,"video",4),T()),o&2){let t=v();i(),a("src",t.imageUrl,C)}}function ct(o,e){if(o&1&&c(0,"img",5),o&2){let t=v();a("src",t.imageUrl,C)}}var V=class o{imageUrl;isVideo(e){return[".mp4",".webm",".ogg"].some(n=>e?.toLowerCase().endsWith(n))}static \u0275fac=function(t){return new(t||o)};static \u0275cmp=p({type:o,selectors:[["app-post-media"]],inputs:{imageUrl:"imageUrl"},decls:5,vars:2,consts:[["showImage",""],[1,"insta-post-wrapper"],[1,"insta-post-box"],[4,"ngIf","ngIfElse"],["controls","","autoplay","","muted","",1,"post-media",3,"src"],["alt","Post Media",1,"post-media",3,"src"]],template:function(t,n){if(t&1&&(r(0,"div",1)(1,"div",2),f(2,mt,2,1,"ng-container",3)(3,ct,1,1,"ng-template",null,0,j),s()()),t&2){let d=E(4);i(2),a("ngIf",n.isVideo(n.imageUrl))("ngIfElse",d)}},dependencies:[l,O],styles:[".insta-post-wrapper[_ngcontent-%COMP%]{width:100%;max-width:600px;margin:0 auto}.insta-post-box[_ngcontent-%COMP%]{position:relative;width:100%;padding-top:100%;background-color:#000;border-radius:12px;overflow:hidden;box-shadow:0 2px 12px #00000026}.post-media[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;border-radius:0}"]})};function dt(o,e){if(o&1&&(r(0,"div",2)(1,"strong"),m(2),s(),m(3),s()),o&2){let t=e.$implicit;i(2),P(t.user.username),i(),I(": ",t.content," ")}}var $=class o{comments=[];static \u0275fac=function(t){return new(t||o)};static \u0275cmp=p({type:o,selectors:[["app-post-comments"]],inputs:{comments:"comments"},decls:2,vars:1,consts:[[1,"post-comments"],["class","comment",4,"ngFor","ngForOf"],[1,"comment"]],template:function(t,n){t&1&&(r(0,"div",0),f(1,dt,4,2,"div",1),s()),t&2&&(i(),a("ngForOf",n.comments))},dependencies:[l,x],styles:[".post-comments[_ngcontent-%COMP%]{margin-top:10px}.comment[_ngcontent-%COMP%]{padding:5px 0}"]})};var z=class o{user;createdAt;static \u0275fac=function(t){return new(t||o)};static \u0275cmp=p({type:o,selectors:[["app-user-header"]],inputs:{user:"user",createdAt:"createdAt"},decls:8,vars:6,consts:[[1,"user-header"],["alt","Profile",1,"avatar",3,"src"],[2,"color","beige"],[1,"time"]],template:function(t,n){t&1&&(r(0,"div",0),c(1,"img",1),r(2,"div")(3,"strong",2),m(4),s(),r(5,"div",3),m(6),J(7,"date"),s()()()),t&2&&(i(),a("src",n.user.profilePictureUrl,C),i(3),P(n.user.username),i(2),P(K(7,3,n.createdAt,"short")))},dependencies:[l,Q],styles:[".user-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;margin-bottom:10px}.avatar[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:50%}.time[_ngcontent-%COMP%]{font-size:12px;color:gray}"]})};function ft(o,e){if(o&1&&(r(0,"span",2),m(1),s()),o&2){let t=e.$implicit;i(),I("#",t.name,"")}}var L=class o{tags=[];static \u0275fac=function(t){return new(t||o)};static \u0275cmp=p({type:o,selectors:[["app-post-tags"]],inputs:{tags:"tags"},decls:2,vars:1,consts:[[1,"post-tags"],["class","tag",4,"ngFor","ngForOf"],[1,"tag"]],template:function(t,n){t&1&&(r(0,"div",0),f(1,ft,2,1,"span",1),s()),t&2&&(i(),a("ngForOf",n.tags))},dependencies:[l,x],encapsulation:2})};var R=class o{post;static \u0275fac=function(t){return new(t||o)};static \u0275cmp=p({type:o,selectors:[["app-post"]],inputs:{post:"post"},decls:6,vars:6,consts:[[1,"post-card"],[3,"user","createdAt"],[3,"imageUrl"],[3,"likes"],[3,"tags"],[3,"comments"]],template:function(t,n){t&1&&(r(0,"div",0),c(1,"app-user-header",1)(2,"app-post-media",2)(3,"app-post-actions",3)(4,"app-post-tags",4)(5,"app-post-comments",5),s()),t&2&&(i(),a("user",n.post.user)("createdAt",n.post.createdAt),i(),a("imageUrl",n.post.contentUrl),i(),a("likes",n.post.likes),i(),a("tags",n.post.tags),i(),a("comments",n.post.comments))},dependencies:[l,H,V,$,z,L],encapsulation:2})};function ut(o,e){if(o&1&&(r(0,"div",2),c(1,"app-post",3),s()),o&2){let t=e.$implicit;i(),a("post",t)}}var B=class o{posts=[];static \u0275fac=function(t){return new(t||o)};static \u0275cmp=p({type:o,selectors:[["app-post-list"]],inputs:{posts:"posts"},decls:2,vars:1,consts:[[1,"post-list"],["class","post-item",4,"ngFor","ngForOf"],[1,"post-item"],[3,"post"]],template:function(t,n){t&1&&(r(0,"div",0),f(1,ut,2,1,"div",1),s()),t&2&&(i(),a("ngForOf",n.posts))},dependencies:[l,x,R],encapsulation:2})};var Y=class o{constructor(e){this.http=e}baseUrl="https://api.example.com";likePost(e){return this.http.post(`${this.baseUrl}/posts/${e}/like`,{})}getComments(e){return this.http.get(`${this.baseUrl}/posts/${e}/comments`)}addComment(e,t){return this.http.post(`${this.baseUrl}/posts/${e}/comments`,{comment:t})}static \u0275fac=function(t){return new(t||o)(U(w))};static \u0275prov=S({token:o,factory:o.\u0275fac,providedIn:"root"})};var G=class o{constructor(e){this.http=e}apiUrl="https://localhost:7038/api/posts";getPostById(e){return this.http.get(`${this.apiUrl}/${e}`)}getAllPosts(){return this.http.get(this.apiUrl)}createPost(e){return this.http.post(this.apiUrl,e)}updatePost(e,t){return this.http.put(`${this.apiUrl}/${e}`,t)}deletePost(e){return this.http.delete(`${this.apiUrl}/${e}`)}static \u0275fac=function(t){return new(t||o)(U(w))};static \u0275prov=S({token:o,factory:o.\u0275fac,providedIn:"root"})};function vt(o,e){if(o&1){let t=M();r(0,"app-story",7),y("storyUploaded",function(){_(t);let d=v();return b(d.loadStories())}),s()}if(o&2){let t=v();a("profilePictureUrl",t.loggedInUserStory.user==null?null:t.loggedInUserStory.user.profilePictureUrl)("username",t.loggedInUserStory.user==null?null:t.loggedInUserStory.user.username)("storyUrl",t.loggedInUserStory.contentUrl)("isCurrentUser",!0)}}function Ct(o,e){if(o&1){let t=M();r(0,"app-story",8),y("storyUploaded",function(){_(t);let d=v();return b(d.loadStories())}),s()}if(o&2){let t=e.$implicit;a("profilePictureUrl",t.user==null?null:t.user.profilePictureUrl)("username",t.user==null?null:t.user.username)("storyUrl",t.contentUrl)}}var st=class o{constructor(e,t,n,d){this.storyService=e;this.homeService=t;this.authService=n;this.postservice=d}stories=[];currentUserId=null;loggedInUserStory=null;otherUserStories=[];posts=[];loadStories(){this.storyService.getActiveStories().subscribe({next:e=>{this.stories=e,this.loggedInUserStory=this.stories.find(t=>t.userId===this.currentUserId)||null,this.otherUserStories=this.stories.filter(t=>t.userId!==this.currentUserId),console.log(this.stories)},error:e=>{console.error("Error fetching stories:",e)}})}loadPosts(){this.postservice.getAllPosts().subscribe({next:e=>{this.posts=e,console.log("Posts loaded:",this.posts)},error:e=>{console.error("Error fetching stories:",e)}})}ngOnInit(){let e=this.authService.getUserIdFromToken();this.currentUserId=e,this.loadStories(),this.loadPosts()}static \u0275fac=function(t){return new(t||o)(g(D),g(Y),g(Z),g(G))};static \u0275cmp=p({type:o,selectors:[["app-home"]],decls:7,vars:3,consts:[[1,"story-container"],[1,"story-list-wrapper"],[1,"story-list"],[3,"profilePictureUrl","username","storyUrl","isCurrentUser","storyUploaded",4,"ngIf"],[3,"profilePictureUrl","username","storyUrl","storyUploaded",4,"ngFor","ngForOf"],[1,"scrollable-content"],[3,"posts"],[3,"storyUploaded","profilePictureUrl","username","storyUrl","isCurrentUser"],[3,"storyUploaded","profilePictureUrl","username","storyUrl"]],template:function(t,n){t&1&&(r(0,"div",0)(1,"div",1)(2,"div",2),f(3,vt,1,4,"app-story",3)(4,Ct,1,3,"app-story",4),s()()(),r(5,"div",5),c(6,"app-post-list",6),s()),t&2&&(i(3),a("ngIf",n.loggedInUserStory),i(),a("ngForOf",n.otherUserStories),i(2),a("posts",n.posts))},dependencies:[l,x,O,X,A,B],styles:['.story-container[_ngcontent-%COMP%]{position:fixed;top:0;width:100%;background-color:#000;z-index:1000;padding:10px 0;border-bottom:1px solid #333}.story-list[_ngcontent-%COMP%]{display:flex;overflow-x:auto;padding:0 16px;gap:14px;scroll-snap-type:x mandatory;scroll-behavior:smooth}.story-list[_ngcontent-%COMP%]::-webkit-scrollbar{height:6px}.story-list[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background-color:#444;border-radius:3px}.story-list[_ngcontent-%COMP%]:before, .story-list[_ngcontent-%COMP%]:after{content:"";position:absolute;top:0;bottom:0;width:20px;pointer-events:none}.story-list[_ngcontent-%COMP%]:before{left:0;background:linear-gradient(to right,#000,transparent)}.story-list[_ngcontent-%COMP%]:after{right:0;background:linear-gradient(to left,#000,transparent)}app-story[_ngcontent-%COMP%]{flex:0 0 auto;scroll-snap-align:start;display:flex;flex-direction:column;align-items:center;text-align:center;color:#fff}app-story[_ngcontent-%COMP%]:hover{transform:scale(1.05);transition:transform .2s}app-story[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:60px;height:60px;border-radius:50%;border:2px solid #c13584;object-fit:cover;margin-bottom:5px}.scrollable-content[_ngcontent-%COMP%]{margin-top:110px;padding:20px;background-color:#111;min-height:100vh;width:70%}']})};export{st as HomeComponent};
